import React from 'react'
import Helmet from 'react-helmet'
import { compose } from 'redux'
import { connect } from 'react-redux'
import { connectRequest } from 'redux-query'

import api from '../../services'
import { Loading } from '../../components'

import Summary from './Summary/Summary'
import Table from './Table/Table'

@compose(
  connect(state => ({
    cve: state.db.cve
  })),
  connectRequest(props => props.params.id
    ? api.get('cve', props.params.id)
    : api.getAll('cve')
  )
)
class CVE extends React.Component {
  render ({ params, cve } = this.props) {
    return (
      <article>
        <Helmet title='Home' />
        <Loading render={cve} title='CVE View' tip='Loading CVE...'>
          <section>
            {cve && (Array.isArray(cve)
              ? <Table data={cve} />
              : <Summary {...cve} />
            )}
          </section>
        </Loading>
      </article>
    )
  }
}

export default CVE
